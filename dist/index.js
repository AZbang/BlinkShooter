"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}();!function t(e,s,i){function a(o,r){if(!s[o]){if(!e[o]){var l="function"==typeof require&&require;if(!r&&l)return l(o,!0);if(n)return n(o,!0);throw new Error("Cannot find module '"+o+"'")}var h=s[o]={exports:{}};e[o][0].call(h.exports,function(t){var s=e[o][1][t];return a(s||t)},h,h.exports,t,e,s,i)}return s[o].exports}for(var n="function"==typeof require&&require,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(t,e,s){var i=t("./Entity"),a=function(t){function e(t,s,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"robot";_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s,i,a));return n.flags=n.level.patruleFlags.slice(0),n.flags.forEach(function(t,e){var s=n.level.layerMap,i=s.getTileX(n.sprite.x+n.sprite.width/2),a=s.getTileY(n.sprite.y+n.sprite.height/2),o=s.getTileX(t.x+t.width/2),r=s.getTileY(t.y+t.height/2);n.level.pathfinder.setCallbackFunction(function(t){null==t&&n.flags.splice(e,1)}),n.level.pathfinder._easyStar.enableDiagonals(),n.level.pathfinder.preparePathCalculation([i,a],[o,r]),n.level.pathfinder.calculatePath()}),n.isPatruleMode=!0,n.findPathToFlag(),n}return _inherits(e,t),_createClass(e,[{key:"update",value:function(){if(this.level.physics.arcade.distanceBetween(this.sprite,this.level.player.sprite)<this.radiusVisibility){var t=this.level.physics.arcade.angleToXY(this.sprite,this.level.player.sprite.x,this.level.player.sprite.y);this.level.add.tween(this.sprite).to({rotation:t},this.speed/2).start(),this.weapon.fire(),this.isPatruleMode=!1}}},{key:"onWounded",value:function(){!this.hp--&&this.dead()}},{key:"findPathToFlag",value:function(){var t=this;if(this.isPatruleMode){this.flag=this.findСlosestFlag(),this.flag.countRepeat=Math.round(this.flags.length/2);var e=this.level.layerMap,s=e.getTileX(this.sprite.x+this.sprite.width/2),i=e.getTileY(this.sprite.y+this.sprite.height/2),a=e.getTileX(this.flag.x+this.flag.width/2),n=e.getTileY(this.flag.y+this.flag.height/2);this.level.pathfinder.setCallbackFunction(function(e){null!=e&&t.moveToFlag(e)}),this.level.pathfinder.preparePathCalculation([s,i],[a,n]),this.level.pathfinder.calculatePath()}}},{key:"moveToFlag",value:function(t){var e=this,s=0,i=this.level.time.create(!1);i.loop(this.speed,function(){if(s++,null==t[s]||!e.isPatruleMode)return i.destroy(),void e.level.time.events.add(1e3,e.findPathToFlag,e);e.level.add.tween(e.sprite).to({rotation:e.level.physics.arcade.angleToXY(e.sprite,16*t[s].x+8,16*t[s].y+8)},e.speed/2).start(),e.level.physics.arcade.moveToXY(e.sprite,16*t[s].x+8,16*t[s].y+8,30,e.speed)},this),i.start()}},{key:"findСlosestFlag",value:function(){var t=this,e=1/0,s=void 0;return this.flags.forEach(function(i){var a=t.level.physics.arcade.distanceBetween(t.sprite,i);if(e>a){if(t.flag&&i.countRepeat)return void i.countRepeat--;e=a,s=i}}),s||this.flag}}]),e}(i);e.exports=a},{"./Entity":2}],2:[function(t,e,s){var i=t("./Weapon.js"),a=t("./entities.json"),n=function(){function t(e,s,i,n){_classCallCheck(this,t),this.type=n,this.level=e,this.x=null!=s?s:0,this.y=null!=i?i:0,this._entity=a[n],this.hp=null!=this._entity.hp?this._entity.hp:10,this.jumping=null!=this._entity.jump?this._entity.jump:2,this.speed=null!=this._entity.speed?this._entity.speed:100,this.radiusVisibility=null!=this._entity.radiusVisibility?this._entity.radiusVisibility:100,this.isJumping=!1,this.isDead=!1,this.headId=null!=this._entity.head?this._entity.head:0,this.bodyId=null!=this._entity.body?this._entity.body:0,this.attachToBodyId=null!=this._entity.attachToBody?this._entity.attachToBody:0,this.weaponId=null!=this._entity.weapon?this._entity.weapon:"blaster",this._createPhaserObjects()}return _createClass(t,[{key:"_createPhaserObjects",value:function(){this.fxJump=this.level.add.sprite(this.x,this.y,"fx_jump",0),this.fxJump.alpha=0,this.fxJump.scale.set(2),this.fxJump.anchor.set(.5),this.fxJump.smoothed=!1,this.fxJump.animations.add("active"),this.sprite=this.level.add.sprite(this.x,this.y,"bodies",this.bodyId),this.sprite.anchor.set(.5),this.sprite.smoothed=!1,this.sprite.class=this,this.head=this.level.make.sprite(-12,-7,"heads",this.headId),this.head.smoothed=!1,this.sprite.addChild(this.head),this.attachToBody=this.level.make.sprite(3.5,-4,"attachToBody",this.attachToBodyId),this.attachToBody.smoothed=!1,this.sprite.addChild(this.attachToBody),this.weapon=new i(this,this.weaponId),this.level.physics.arcade.enable(this.sprite),this.sprite.body.drag.set(150),this.sprite.body.maxVelocity.set(100),this.sprite.syncBounds=!0,this.tweenBreathe=this.level.add.tween(this.sprite.scale).to({x:1.1,y:1.1},600).to({x:1,y:1},500).loop(),this.tweenBreathe.start()}},{key:"_update",value:function(){var t=this;if(!this.isDead){this.level.physics.arcade.collide(this.sprite,this.level.firstLayerMap),this.weapon.update();for(var e=this.level.bullets.children,s=0;s<e.length;s++)this.constructor.name!==e[s].typeOwner&&this.level.physics.arcade.overlap(e[s],this.sprite,function(e,s){!t.isJumping&&s.scale.x<1&&(t.sprite.body.velocity.x+=10*Math.cos(t.sprite.rotation),t.sprite.body.velocity.y+=10*Math.sin(t.sprite.rotation),t.onWounded&&t.onWounded(),s.kill())});if(!this.isJumping)for(var i=0;i<this.level.deadAreas.length;i++){var a=this.level.deadAreas[i],n=new Phaser.Rectangle(this.sprite.body.x,this.sprite.body.y,this.sprite.body.width,this.sprite.body.height);if(Phaser.Rectangle.intersects(a,n))return this.sprite.body.acceleration.set(0),void this.fallDead()}this.isJumping&&this.weapon.updateTrack(),this.update&&this.update()}}},{key:"jump",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.jumping;this.isJumping=!0,this.tweenBreathe.pause(),this.tweenJump=this.level.add.tween(this.sprite.scale).to({x:e,y:e},300,Phaser.Easing.Quadratic.Out).to({x:1,y:1},300,Phaser.Easing.Quintic.In).start(),this.tweenJump.onComplete.add(function(){t.isJumping=!1,t.tweenBreathe.resume(),t.weapon.updateTrack()},this)}},{key:"dead",value:function(){this.sprite.kill(),this.isDead=!0,this.onDead&&this.onDead()}},{key:"fallDead",value:function(){var t=this;this.isDead=!0,this.level.add.tween(this.sprite.scale).to({x:0,y:0},300,Phaser.Easing.Quadratic.In,!0).onComplete.add(function(){t.onDead&&t.onDead()})}}]),t}();e.exports=n},{"./Weapon.js":5,"./entities.json":6}],3:[function(t,e,s){var i=function(){function t(e,s){_classCallCheck(this,t),this.level=e,this.padding={x:10,y:10},this.lifebox=this.level.add.sprite(this.padding.x,this.padding.y,"lifebox"),this.lifebox.fixedToCamera=!0,this.hp=s.hp;for(var i=0;i<this.hp;i++){var a=this.level.add.sprite(7*i+12,6,"liferect");this.lifebox.addChild(a)}this.scores=s.scores,this.textScores=this.level.add.bitmapText(this.padding.x+10,this.padding.y+30,"font",this.scores,20),this.textScores.fixedToCamera=!0,this.textScores.smoothed=!1,this.timerHP=this.level.time.create(!1),this.timerScores=this.level.time.create(!1),this.timerText=this.level.time.create(!1),this.textWindow=this.level.add.sprite(90,this.padding.y,"window"),this.textWindow.alpha=0,this.textWindow.fixedToCamera=!0,this.textWindow.inputEnabled=!0;var n=this.level.add.bitmapText(20,5,"font2",null,13);this.textWindow.addChild(n);var o=this.level.add.bitmapText(this.textWindow.width-5,this.textWindow.height-10,"font2","TAP TO CONTINUE",15);o.anchor.set(1),this.textWindow.addChild(o),this.blinkInfoText=this.level.add.tween(o).to({alpha:0},300).to({alpha:1},300).loop(),this.fxVoice=this.level.add.sprite(this.padding.x+15,this.textWindow.height+this.textWindow.y,"fx_voice",0),this.fxVoice.anchor.set(0,1),this.fxVoice.scale.set(2),this.fxVoice.alpha=0,this.fxVoice.fixedToCamera=!0,this.fxVoice.smoothed=!1,this.fxVoice.animations.add("active")}return _createClass(t,[{key:"showTextWindow",value:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.textWindow.children[0].text="",t["text"+s]){this.level.add.tween(this.textWindow).to({alpha:1},500).start(),this.blinkInfoText.start(),this.fxVoice.alpha=1,this.fxVoice.play("active",10,!0),this.textWindow.inputEnabled=!0,this.textWindow.events.onInputUp.add(function(){e.showTextWindow(t,s+1)});var i=0,a=t["text"+s];this.timerText.loop(50,function(){if(!a[i])return void e.timerText.stop();e.textWindow.children[0].text+=a[i],i++}),this.timerText.start()}else this.fxVoice.alpha=0,this.fxVoice.animations.stop(null,!0),this.blinkInfoText.stop(),this.timerText.stop(),this.level.add.tween(this.textWindow).to({alpha:0},500).start(),this.textWindow.inputEnabled=!1,this.currentTextWindow=1}},{key:"setHP",value:function(t){var e=this;if(!(t<0||t>=8)){var s=t-this.hp>0?1:0;this.timerHP.loop(100,function(){if(e.hp===t||e.hp<1||e.hp>8)return void e.timerHP.stop();e.level.add.tween(e.lifebox.children[e.hp-1]).to({alpha:s},20).to({alpha:1-s},20).to({alpha:s},20).to({alpha:1-s},20).to({alpha:s},20).start(),s?e.hp++:e.hp--}).start()}}},{key:"setScores",value:function(t){var e=this,s=t-this.scores>0?1:0;this.timerScores.loop(10,function(){if(e.scores===t||e.scores<=0)return void e.timerScores.stop();s?e.scores++:e.scores--,e.textScores.text=e.scores}),this.timerScores.start()}}]),t}();e.exports=i},{}],4:[function(t,e,s){var i=t("./Entity.js"),a=t("./LevelInterface"),n=function(t){function e(t,s,i){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,s,i,"player"));return n.level.camera.follow(n.sprite,Phaser.Camera.FOLLOW_LOCKON,.1,.1),n.interface=new a(n.level,{hp:Math.min(8,n.hp),scores:100}),n.cursors=n.level.input.keyboard.createCursorKeys(),n.jumpButton=n.level.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),n.fireButton=n.level.input.keyboard.addKey(Phaser.Keyboard.Z),n.buttonFire=n.level.add.button(435,210,"buttonFire"),n.buttonFire.anchor.set(.5),n.buttonFire.scale.set(2.5),n.buttonFire.smoothed=!1,n.buttonFire.fixedToCamera=!0,n.buttonFire.onInputDown.add(function(){n.interface.scores&&n.weapon.fire()&&n.interface.setScores(n.interface.scores-10)}),n.buttonJump=n.level.add.button(375,230,"buttonJump"),n.buttonJump.anchor.set(.5),n.buttonJump.scale.set(2),n.buttonJump.smoothed=!1,n.buttonJump.fixedToCamera=!0,n.buttonJump.onInputDown.add(function(){n.isJumping||(n.fxJump.play("active",20),n.fxJump.alpha=1,n.fxJump.x=n.sprite.body.x+5,n.fxJump.y=n.sprite.body.y+5,n.level.add.tween(n.fxJump).to({alpha:0},600).start(),n.jump(n.jumping))}),n}return _inherits(e,t),_createClass(e,[{key:"update",value:function(){var t=this;this.level.physics.arcade.overlap(this.sprite,this.level.items,function(e,s){s.isCollide||("health"==s.type?t.interface.setHP(t.interface.hp+2):"coins"==s.type?t.interface.setScores(t.interface.scores+100):"cartridge"==s.type&&(t.isCatridgeUse=!0),s.tween&&s.tween.stop(),s.isCollide=!0,t.level.add.tween(s.scale).to({x:0,y:0},600,Phaser.Easing.Bounce.In).start().onComplete.add(function(){return s.kill}))});var e=new Phaser.Rectangle(this.sprite.body.x,this.sprite.body.y,this.sprite.body.width,this.sprite.body.height);this.isCatridgeUse&&Phaser.Rectangle.intersects(this.level.nextLevelArea,e)&&(this.level.nextLevel(),this.isCatridgeUse=!1);for(var s=0;s<this.level.textAreas.length;s++){var i=this.level.textAreas[s];if(Phaser.Rectangle.intersects(i,e))return this.interface.showTextWindow(i),void this.level.textAreas.splice(s,1)}var a=Phaser.Math.degToRad(Phaser.Math.radToDeg(this.level.vjoy.rotation));this.level.vjoy.isDown?(this.level.physics.arcade.velocityFromRotation(a,100,this.sprite.body.velocity),this.sprite.rotation=a):this.sprite.body.velocity.set(0)}},{key:"onWounded",value:function(){this.interface.setHP(this.interface.hp-1),0===this.interface.hp&&this.onDead()}},{key:"onDead",value:function(){this.level.state.restart()}}]),e}(i);e.exports=n},{"./Entity.js":2,"./LevelInterface":3}],5:[function(t,e,s){var i=t("./weapons.json"),a=function(){function t(e,s){_classCallCheck(this,t),this.level=e.level,this.person=e,this._weapons=i[s],this.id=null!=this._weapons.id?this._weapons.id:0,this.trackX=null!=this._weapons.trackX?this._weapons.trackX:16,this.trackY=null!=this._weapons.trackY?this._weapons.trackY:4,this.speed=null!=this._weapons.speed?this._weapons.speed:100,this.damage=null!=this._weapons.damage?this._weapons.damage:1,this.delay=null!=this._weapons.delay?this._weapons.delay:10,this.quantity=null!=this._weapons.quantity?this._weapons.quantity:1,this.weapon=this.level.add.weapon(this.quantity,"bullets",this.id,this.level.bullets),this.weapon.setBulletFrames(this.id,this.id,!0),this.weapon.bulletKillType=Phaser.Weapon.KILL_WORLD_BOUNDS,this.weapon.bulletSpeed=this.speed,this.weapon.fireRate=this.delay,this.weapon.bullets.typeOwner=this.person.constructor.name,this.fxFire=this.level.add.sprite(0,0,"fx_fire",0),this.fxFire.alpha=0,this.fxFire.scale.set(2),this.fxFire.anchor.set(.5),this.fxFire.smoothed=!1,this.fxFire.animations.add("active"),this.fxCollide=this.level.add.sprite(0,0,"fx_explosion",0),this.fxCollide.alpha=0,this.fxCollide.anchor.set(.5),this.fxCollide.smoothed=!1,this.fxCollide.animations.add("active"),this.updateTrack()}return _createClass(t,[{key:"updateTrack",value:function(){var t=this.trackX*this.person.sprite.scale.x,e=this.trackY*this.person.sprite.scale.y;this.weapon.trackSprite(this.person.sprite,t,e,!0)}},{key:"fire",value:function(){var t=this.weapon.fire();if(t)return t.smoothed=!1,t.scale.setTo(this.person.sprite.scale.x/2,this.person.sprite.scale.y/2),t.body.updateBounds(),this.person.sprite.body.velocity.x-=100*Math.cos(this.person.sprite.rotation),this.person.sprite.body.velocity.y-=100*Math.sin(this.person.sprite.rotation),this.fxFire.scale.x=this.person.sprite.scale.x,this.fxFire.scale.y=this.person.sprite.scale.y,this.fxFire.x=this.weapon._rotatedPoint.x,this.fxFire.y=this.weapon._rotatedPoint.y,this.fxFire.alpha=1,this.fxFire.play("active",20),this.level.add.tween(this.fxFire).to({alpha:0},600).start(),!0}},{key:"update",value:function(){var t=this;this.level.physics.arcade.collide(this.weapon.bullets,this.level.firstLayerMap,function(e,s){t.fxCollide.x=e.x,t.fxCollide.y=e.y,t.fxCollide.alpha=1,t.fxCollide.play("active",100),t.level.add.tween(t.fxCollide).to({alpha:0},300).start(),s.tint=16580352,e.kill()})}}]),t}();e.exports=a},{"./weapons.json":7}],6:[function(t,e,s){e.exports={player:{hp:10,jump:3,speed:100,head:5,body:3,attachToBody:1,weapon:"blaster"},robot:{hp:3,jump:3,speed:100,radiusVisibility:150,head:7,body:1,attachToBody:1,weapon:"blaster"},robot2:{hp:10,jump:3,speed:100,radiusVisibility:150,head:10,body:3,attachToBody:1,weapon:"blaster"},robot3:{hp:10,jump:3,speed:100,radiusVisibility:150,head:13,body:3,attachToBody:1,weapon:"blaster"}}},{}],7:[function(t,e,s){e.exports={roket:{id:1,range:100,speed:400,damage:10,delay:10,quantity:10,trackX:1,trackY:1},blaster:{id:3,range:100,speed:400,damage:10,delay:200,quantity:2},blaster2:{id:1,range:100,speed:100,damage:10,delay:10,quantity:10,trackX:1,trackY:1},blaster3:{id:1,range:100,speed:100,damage:10,delay:10,quantity:10,trackX:1,trackY:1},blaster4:{id:1,range:100,speed:100,damage:10,delay:10,quantity:10,trackX:1,trackY:1},saber:{id:null,range:100,speed:100,damage:10,delay:10,quantity:10,trackX:1,trackY:1},revolver:{id:1,range:100,speed:100,damage:10,delay:10,quantity:10,trackX:1,trackY:1},rifle:{id:1,range:100,speed:100,damage:10,delay:10,quantity:10,trackX:1,trackY:1},fist:{id:null,range:100,speed:100,damage:10,delay:10,quantity:10,trackX:1,trackY:1},machinegun:{id:1,range:100,speed:100,damage:10,delay:10,quantity:10,trackX:1,trackY:1},bazooka:{id:1,range:100,speed:100,damage:10,delay:10,quantity:10,trackX:1,trackY:1},energygun:{id:1,range:100,speed:100,damage:10,delay:10,quantity:10,trackX:1,trackY:1}}},{}],8:[function(t,e,s){var i=t("./states/Boot.js"),a=t("./states/Preload.js"),n=t("./states/Menu.js"),o=t("./states/Level.js"),r=t("./states/Settings.js"),l=t("./states/LevelManager.js"),h=function(){var t=new Phaser.Game(480,320,Phaser.AUTO,"ShooterBlink");t.state.add("Menu",n),t.state.add("Settings",r),t.state.add("Level",o),t.state.add("LevelManager",l),t.state.add("Preload",a),t.state.add("Boot",i,!0)};window.cordova?document.addEventListener("deviceready",h,!1):window.onload=h},{"./states/Boot.js":10,"./states/Level.js":11,"./states/LevelManager.js":12,"./states/Menu.js":13,"./states/Preload.js":14,"./states/Settings.js":15}],9:[function(t,e,s){var i={addTextButton:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments[2],a=arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,o=arguments[5],r=i.addText(t,e,s,a,n);return i.setButton(r,o),r},addText:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments[2],a=arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,o=i.game.add.bitmapText(t,e,s,a,n);return o.smoothed=!1,o.anchor.set(.5),o},addIconButton:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments[2],a=arguments[3],n=arguments[4],o=i.game.add.sprite(t,e,s,a);return o.smoothed=!1,o.scale.set(1.5),i.setButton(o,n),o},setButton:function(t,e){t.inputEnabled=!0;var s=t.scale.x,a=t.scale.y;t.events.onInputDown.add(function(){t.disable||i.game.add.tween(t.scale).to({x:s+.3,y:a+.3},300).start()}),t.events.onInputUp.add(function(){t.disable||e()}),t.events.onInputOver.add(function(){t.disable||i.game.add.tween(t.scale).to({x:s+.3,y:a+.3},300).start()}),t.events.onInputOut.add(function(){t.disable||i.game.add.tween(t.scale).to({x:s,y:a},300).start()})}};e.exports=i},{}],10:[function(t,e,s){var i=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"init",value:function(){this.w=480,this.h=320}},{key:"create",value:function(){this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.fullScreenScaleMode=Phaser.ScaleManager.EXACT_FIT,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.scale.setMaximum(),this.game.renderer.renderSession.roundPixels=!0,Phaser.Canvas.setImageRenderingCrisp(this.game.canvas),this.state.start("Preload")}}]),t}();e.exports=i},{}],11:[function(t,e,s){var i=t("../game/Player"),a=t("../game/Enemy"),n=(t("../mixins/UI.js"),function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"create",value:function(){this.map=this.game.add.tilemap("level"+this.game.currentLevel,16,16),this.map.addTilesetImage("tilemap"),this.map.debugMap=!0,this.bg=this.game.add.tileSprite(0,0,1e4,1e4,"bg"),this.world.setBounds(0,0,1e4,1e4),this.firstLayerMap=this.map.createLayer("map1"),this.firstLayerMap.resizeWorld(),this.firstLayerMap.smoothed=!1,this.secondLayerMap=this.map.createLayer("map2"),this.secondLayerMap.resizeWorld(),this.secondLayerMap.smoothed=!1;var t=[],e=this.map.tilesets[0].tileProperties;for(var s in e)"false"===e[s].solid?t.push(+s):"true"===e[s].solid&&this.map.setCollision(+s,!0,this.firstLayerMap);this.vjoy=this.game.plugins.add(Phaser.Plugin.VJoy),this.vjoy.enable(),this.pathfinder=this.game.plugins.add(Phaser.Plugin.PathFinderPlugin),this.pathfinder.setGrid(this.map.layers[0].data,t),this._createTextAreas(),this._createDeadAreas(),this._createPatruleFlags(),this._createItems(),this._createEnemies(),this.bullets=this.add.group();var a=this.map.objects.nextLevelArea[0];this.nextLevelArea=new Phaser.Rectangle(a.x,a.y,a.width,a.height);var n=this.map.objects.player[0];this.player=new i(this,n.x+n.width/2,n.y+n.height/2)}},{key:"_createEnemies",value:function(){var t=this;this.enemies=this.game.add.group(),this.map.objects.spawner&&this.map.objects.spawner.forEach(function(e){var s=new a(t,e.x+e.width/2,e.y+e.height/2,e.properties.type);t.enemies.add(s.sprite)})}},{key:"_createItems",value:function(){var t=this;this.items=this.add.group(),this.items.enableBody=!0,this.map.objects.items&&this.map.objects.items.forEach(function(e){var s=void 0;if("coins"==e.properties.type){var i=e.properties.order||0;s=t.add.sprite(e.x+e.width/2,e.y+e.height/2,"token",0),s.animations.add("rotation"),s.play("rotation",7,!0),s.scale.set(.7),i&&(s.tint=16770048),s.tween=t.add.tween(s.scale).to({x:.9,y:.9},300).to({x:.7,y:.7},400).loop().start()}else{var a=void 0;"health"==e.properties.type?a=1:"cartridge"==e.properties.type&&(a=3),s=t.add.sprite(e.x+e.width/2,e.y+e.height/2,"items",a),s.tween=t.add.tween(s.scale).to({x:1.1,y:1.1},300).to({x:.8,y:.8},400).to({x:1,y:1},400).loop().start()}s.type=e.properties.type,s.anchor.set(.5),s.smoothed=!1,t.items.add(s)})}},{key:"_createPatruleFlags",value:function(){var t=this;this.patruleFlags=[],this.map.objects.moving&&this.map.objects.moving.forEach(function(e){var s=new Phaser.Rectangle(e.x,e.y,e.width,e.height);t.patruleFlags.push(s)})}},{key:"_createDeadAreas",value:function(){var t=this;this.deadAreas=[],this.map.objects.deadAreas&&this.map.objects.deadAreas.forEach(function(e){var s=new Phaser.Rectangle(e.x,e.y,e.width,e.height);t.deadAreas.push(s)})}},{key:"_createTextAreas",value:function(){var t=this;this.textAreas=[],this.map.objects.textAreas&&this.map.objects.textAreas.forEach(function(e){for(var s=new Phaser.Rectangle(e.x,e.y,e.width,e.height),i=1;e.properties["text"+i];)s["text"+i]=e.properties["text"+i],i++;t.textAreas.push(s)})}},{key:"nextLevel",value:function(){this.game.currentLevel++,this.game.currentLevel<=this.game.totalLevels?this.state.start("Level"):this.state.start("Menu")}},{key:"update",value:function(){this.bg.tilePosition.y+=10,this.player._update();for(var t=0;t<this.enemies.children.length;t++)this.enemies.children[t].class._update()}}]),t}());e.exports=n},{"../game/Enemy":1,"../game/Player":4,"../mixins/UI.js":9}],12:[function(t,e,s){var i=t("../mixins/UI.js"),a=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"create",value:function(){var t=this;this.world.setBounds(0,0,480,320),this.bg=this.game.add.tileSprite(0,0,this.world.width,this.world.height,"bg"),this.label=i.addText(this.world.centerX+20,50,"font","LEVEL SELECT",30),this.buttonsLevelSelect=this.add.group();for(var e=0,s=0;s<3;s++)for(var a=0;a<8;a++)!function(a){e++;var n=i.addTextButton(45*a+80,45*s+110,"font",e,18,function(){t.game.currentLevel=n.level,t.goLevel()});n.level=e,e>t.game.totalLevels&&(n.tint=11579568,n.disable=!0),t.buttonsLevelSelect.add(n)}(a);this.buttonsLevelSelect.x=this.world.centerX-240,this.btnClose=i.addIconButton(60,45,"ui",0,function(){return t.state.start("Menu")}),this.info=i.addText(10,5,"font2","Powered by azbang @v0.1",14),this.info.anchor.set(0)}},{key:"goLevel",value:function(t){this.state.start("Level")}},{key:"update",value:function(){this.bg.tilePosition.x+=1,this.bg.tilePosition.y+=1}}]),t}();e.exports=a},{"../mixins/UI.js":9}],13:[function(t,e,s){var i=t("../mixins/UI.js"),a=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"create",value:function(){var t=this;this.world.setBounds(0,0,480,320),this.bg=this.add.tileSprite(0,0,this.world.width,this.world.height,"bg"),this.labelPath1=i.addText(160,50,"font","BLINK",35),this.add.tween(this.labelPath1).to({alpha:0},200).to({alpha:1},100).start().loop(),this.labelPart2=i.addText(320,55,"font","SHOOTER",25),this.btnStart=i.addTextButton(this.world.centerX,this.world.centerY-35,"font","START",30,function(){t.state.start("LevelManager")}),this.btnSettings=i.addTextButton(this.world.centerX,this.world.centerY+10,"font","SETTINGS",30,function(){t.state.start("Settings")}),this.info=i.addText(10,5,"font2","Powered by azbang @v0.1",14),this.info.anchor.set(0)}},{key:"update",value:function(){this.bg.tilePosition.x+=1,this.bg.tilePosition.y+=1}}]),t}();e.exports=a},{"../mixins/UI.js":9}],14:[function(t,e,s){var i=t("../mixins/UI.js"),a=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"init",value:function(){i.game=this,this.game.totalLevels=2}},{key:"preload",value:function(){this.load.audio("music1","../assets/music/theme-1.ogg"),this.load.audio("music2","../assets/music/theme-2.ogg"),this.load.audio("music3","../assets/music/theme-3.ogg"),this.load.audio("music4","../assets/music/theme-4.wav"),this.load.image("bg","../assets/bg.png"),this.load.image("lifebox","../assets/UI/lifebox.png"),this.load.image("liferect","../assets/UI/liferect.png"),this.load.image("window","../assets/UI/window.png"),this.load.image("vjoy_body","../assets/UI/body.png"),this.load.image("vjoy_cap","../assets/UI/button.png"),this.load.image("buttonJump","../assets/UI/buttonJump.png"),this.load.image("buttonFire","../assets/UI/buttonFire.png"),this.load.spritesheet("fx_jump","../assets/animations/jump.png",47,45,6),this.load.spritesheet("fx_fire","../assets/animations/fire.png",32,33,6),this.load.spritesheet("fx_explosion","../assets/animations/explosion.png",35,36,7),this.load.spritesheet("fx_hit","../assets/animations/hit.png",16,16,6),this.load.spritesheet("fx_collide","../assets/animations/collide.png",37,37,6),this.load.spritesheet("fx_voice","../assets/animations/voice.png",20,20,7),this.load.spritesheet("token","../assets/animations/token.png",20,20,9),this.load.spritesheet("legs","../assets/animations/legs.png",15,17,4),this.load.bitmapFont("font","../assets/fonts/font.png","../assets/fonts/font.xml"),this.load.bitmapFont("font2","../assets/fonts/font2.png","../assets/fonts/font2.xml"),this.load.atlas("heads","assets/atlases/heads.png","assets/atlases/heads.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.atlas("bodies","assets/atlases/bodies.png","assets/atlases/bodies.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.atlas("attachToBody","assets/atlases/attachToBody.png","assets/atlases/attachToBody.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.atlas("weapons","assets/atlases/weapons.png","assets/atlases/weapons.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.atlas("items","assets/atlases/items.png","assets/atlases/items.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.atlas("bullets","assets/atlases/bullets.png","assets/atlases/bullets.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.atlas("ui","assets/UI/ui.png","assets/UI/ui.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH);for(var t=1;t<=this.game.totalLevels;t++)this.load.tilemap("level"+t,"../assets/levels/level"+t+".json",null,Phaser.Tilemap.TILED_JSON);this.load.image("tilemap","../assets/levels/tilemap.png")}},{key:"create",value:function(){for(var t=[this.add.audio("music1"),this.add.audio("music2"),this.add.audio("music3"),this.add.audio("music4")],e=0;e<t.length;e++)!function(e){!function(){var s=e+1>t.length-1?0:e+1;t[e].onStop.add(function(){return t[s].play()})}()}(e);t[0].play(),this.game.musics=t,this.game.currentLevel=1,this.state.start("Menu")}}]),t}();e.exports=a},{"../mixins/UI.js":9}],15:[function(t,e,s){var i=t("../mixins/UI.js"),a=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"create",value:function(){var t=this;this.world.setBounds(0,0,480,320),this.bg=this.game.add.tileSprite(0,0,this.world.width,this.world.height,"bg"),this.label=i.addText(this.world.centerX+20,50,"font","SETTINGS",30),this.btnClose=i.addIconButton(110,45,"ui",0,function(){return t.state.start("Menu")}),this.param1=i.addText(this.world.centerX,130,"font","MUSIC ON",30),this.param2=i.addText(this.world.centerX,170,"font","SOUNDS ON",30),this.info=i.addText(10,5,"font2","Powered by azbang @v0.1",14),this.info.anchor.set(0)}},{key:"update",value:function(){this.bg.tilePosition.x+=1,this.bg.tilePosition.y+=1}}]),t}();e.exports=a},{"../mixins/UI.js":9}]},{},[8]);